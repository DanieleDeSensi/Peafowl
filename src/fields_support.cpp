#include <peafowl/peafowl.h>
#include <map>

char const* pfwl_fields_l7_names[] = {
  "SIP_FIRST", 
  "SIP_REQUEST_URI", 
  "SIP_METHOD", 
  "SIP_CALLID", 
  "SIP_REASON", 
  "SIP_RTCPXR_CALLID", 
  "SIP_CSEQ", 
  "SIP_CSEQ_METHOD_STRING", 
  "SIP_VIA", 
  "SIP_CONTACT_URI", 
  "SIP_RURI_USER", 
  "SIP_RURI_DOMAIN", 
  "SIP_FROM_USER", 
  "SIP_FROM_DOMAIN", 
  "SIP_TO_USER", 
  "SIP_TO_DOMAIN", 
  "SIP_PAI_USER", 
  "SIP_PAI_DOMAIN", 
  "SIP_PID_URI", 
  "SIP_FROM_URI", 
  "SIP_TO_URI", 
  "SIP_RURI_URI", 
  "SIP_TO_TAG", 
  "SIP_FROM_TAG", 
  "SIP_LAST", 
  "DNS_FIRST", 
  "DNS_NAME_SRV", 
  "DNS_NS_IP_1", 
  "DNS_NS_IP_2", 
  "DNS_AUTH_SRV", 
  "DNS_LAST", 
  "SSL_FIRST", 
  "SSL_CERTIFICATE", 
  "SSL_LAST", 
  "HTTP_FIRST", 
  "HTTP_VERSION_MAJOR", 
  "HTTP_VERSION_MINOR", 
  "HTTP_METHOD", 
  "HTTP_STATUS_CODE", 
  "HTTP_MSG_TYPE", 
  "HTTP_BODY", 
  "HTTP_URL", 
  "HTTP_HEADERS", 
  "HTTP_LAST", 
  "RTP_FIRST", 
  "RTP_PTYPE", 
  "RTP_SEQNUM", 
  "RTP_TIMESTP", 
  "RTP_SSRC", 
  "RTP_LAST", 
  "NUM"
};

const char* pfwl_get_L7_field_name(pfwl_field_id_t field){
   return pfwl_fields_l7_names[field];
}

static std::map<std::string, pfwl_field_id_t> pfwl_fields_l7_names_to_id = {
    {"SIP_FIRST", PFWL_FIELDS_L7_SIP_FIRST},
    {"SIP_REQUEST_URI", PFWL_FIELDS_L7_SIP_REQUEST_URI},
    {"SIP_METHOD", PFWL_FIELDS_L7_SIP_METHOD},
    {"SIP_CALLID", PFWL_FIELDS_L7_SIP_CALLID},
    {"SIP_REASON", PFWL_FIELDS_L7_SIP_REASON},
    {"SIP_RTCPXR_CALLID", PFWL_FIELDS_L7_SIP_RTCPXR_CALLID},
    {"SIP_CSEQ", PFWL_FIELDS_L7_SIP_CSEQ},
    {"SIP_CSEQ_METHOD_STRING", PFWL_FIELDS_L7_SIP_CSEQ_METHOD_STRING},
    {"SIP_VIA", PFWL_FIELDS_L7_SIP_VIA},
    {"SIP_CONTACT_URI", PFWL_FIELDS_L7_SIP_CONTACT_URI},
    {"SIP_RURI_USER", PFWL_FIELDS_L7_SIP_RURI_USER},
    {"SIP_RURI_DOMAIN", PFWL_FIELDS_L7_SIP_RURI_DOMAIN},
    {"SIP_FROM_USER", PFWL_FIELDS_L7_SIP_FROM_USER},
    {"SIP_FROM_DOMAIN", PFWL_FIELDS_L7_SIP_FROM_DOMAIN},
    {"SIP_TO_USER", PFWL_FIELDS_L7_SIP_TO_USER},
    {"SIP_TO_DOMAIN", PFWL_FIELDS_L7_SIP_TO_DOMAIN},
    {"SIP_PAI_USER", PFWL_FIELDS_L7_SIP_PAI_USER},
    {"SIP_PAI_DOMAIN", PFWL_FIELDS_L7_SIP_PAI_DOMAIN},
    {"SIP_PID_URI", PFWL_FIELDS_L7_SIP_PID_URI},
    {"SIP_FROM_URI", PFWL_FIELDS_L7_SIP_FROM_URI},
    {"SIP_TO_URI", PFWL_FIELDS_L7_SIP_TO_URI},
    {"SIP_RURI_URI", PFWL_FIELDS_L7_SIP_RURI_URI},
    {"SIP_TO_TAG", PFWL_FIELDS_L7_SIP_TO_TAG},
    {"SIP_FROM_TAG", PFWL_FIELDS_L7_SIP_FROM_TAG},
    {"SIP_LAST", PFWL_FIELDS_L7_SIP_LAST},
    {"DNS_FIRST", PFWL_FIELDS_L7_DNS_FIRST},
    {"DNS_NAME_SRV", PFWL_FIELDS_L7_DNS_NAME_SRV},
    {"DNS_NS_IP_1", PFWL_FIELDS_L7_DNS_NS_IP_1},
    {"DNS_NS_IP_2", PFWL_FIELDS_L7_DNS_NS_IP_2},
    {"DNS_AUTH_SRV", PFWL_FIELDS_L7_DNS_AUTH_SRV},
    {"DNS_LAST", PFWL_FIELDS_L7_DNS_LAST},
    {"SSL_FIRST", PFWL_FIELDS_L7_SSL_FIRST},
    {"SSL_CERTIFICATE", PFWL_FIELDS_L7_SSL_CERTIFICATE},
    {"SSL_LAST", PFWL_FIELDS_L7_SSL_LAST},
    {"HTTP_FIRST", PFWL_FIELDS_L7_HTTP_FIRST},
    {"HTTP_VERSION_MAJOR", PFWL_FIELDS_L7_HTTP_VERSION_MAJOR},
    {"HTTP_VERSION_MINOR", PFWL_FIELDS_L7_HTTP_VERSION_MINOR},
    {"HTTP_METHOD", PFWL_FIELDS_L7_HTTP_METHOD},
    {"HTTP_STATUS_CODE", PFWL_FIELDS_L7_HTTP_STATUS_CODE},
    {"HTTP_MSG_TYPE", PFWL_FIELDS_L7_HTTP_MSG_TYPE},
    {"HTTP_BODY", PFWL_FIELDS_L7_HTTP_BODY},
    {"HTTP_URL", PFWL_FIELDS_L7_HTTP_URL},
    {"HTTP_HEADERS", PFWL_FIELDS_L7_HTTP_HEADERS},
    {"HTTP_LAST", PFWL_FIELDS_L7_HTTP_LAST},
    {"RTP_FIRST", PFWL_FIELDS_L7_RTP_FIRST},
    {"RTP_PTYPE", PFWL_FIELDS_L7_RTP_PTYPE},
    {"RTP_SEQNUM", PFWL_FIELDS_L7_RTP_SEQNUM},
    {"RTP_TIMESTP", PFWL_FIELDS_L7_RTP_TIMESTP},
    {"RTP_SSRC", PFWL_FIELDS_L7_RTP_SSRC},
    {"RTP_LAST", PFWL_FIELDS_L7_RTP_LAST},
    {"NUM", PFWL_FIELDS_L7_NUM},
};
pfwl_field_id_t pfwl_get_L7_field_id(const char* field_name){
    return pfwl_fields_l7_names_to_id[std::string(field_name)];
}
